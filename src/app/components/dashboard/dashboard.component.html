<div class="dashboard-container">
  <section class="welcome-section">
    <h1>Bienvenue {{ username }} ğŸ‘‹</h1>
    <p class="subtitle">Voici un aperÃ§u de vos aventures</p>
  </section>

  <div class="loading" *ngIf="isLoading">
    <p>Chargement de vos statistiques...</p>
  </div>

  <div class="dashboard-content" *ngIf="!isLoading">
    <!-- Stats Cards -->
    <section class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon">ğŸ—ºï¸</div>
        <div class="stat-info">
          <h3>{{ stats.totalVoyages }}</h3>
          <p>Voyages totaux</p>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">ğŸŒ</div>
        <div class="stat-info">
          <h3>{{ stats.publicVoyages }}</h3>
          <p>Voyages partagÃ©s</p>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">ğŸ”’</div>
        <div class="stat-info">
          <h3>{{ stats.privateVoyages }}</h3>
          <p>Voyages privÃ©s</p>
        </div>
      </div>
    </section>

    <!-- Top Destinations -->
    <section class="destinations-section" *ngIf="stats.topDestinations.length > 0">
      <h2>Vos destinations favorites</h2>
      <div class="destinations-list">
        <div class="destination-item" *ngFor="let dest of stats.topDestinations">
          <span class="destination-name">{{ dest.pays }}</span>
          <span class="destination-count">{{ dest.count }} voyage{{ dest.count > 1 ? 's' : '' }}</span>
        </div>
      </div>
    </section>

    <!-- Quick Actions -->
    <section class="actions-section">
      <h2>Actions rapides</h2>
      <div class="actions-grid">
        <a routerLink="/ajouter-voyage" class="action-card">
          <div class="action-icon">â•</div>
          <h3>CrÃ©er un voyage</h3>
          <p>Planifiez votre prochaine aventure</p>
        </a>
      </div>
    </section>

    <!-- Mes Voyages Section -->
    <section class="my-voyages-section">
      <h2>Mes voyages</h2>
      <div class="my-voyages-grid" *ngIf="myVoyages.length > 0; else noVoyages">
        <div class="voyage-card" *ngFor="let voyage of myVoyages" (click)="viewVoyage(voyage)">
          <div class="voyage-image" *ngIf="voyage.imageData || voyage.galleries?.[0]">
            <img [src]="voyage.imageData || voyage.galleries?.[0]" [alt]="voyage.titre" />
          </div>
          <div class="voyage-info">
            <h3>{{ voyage.titre }}</h3>
            <p class="destination">ğŸ“ {{ voyage.destination }}</p>
            <p class="date">ğŸ—“ï¸ {{ voyage.dateDebut | date: 'dd/MM/yyyy' }}</p>
            <span class="badge" [class.badge-public]="voyage.isPublic" [class.badge-private]="!voyage.isPublic">
              {{ voyage.isPublic ? 'Public' : 'PrivÃ©' }}
            </span>
          </div>
        </div>
      </div>
      <ng-template #noVoyages>
        <p class="no-voyages-text">Aucun voyage enregistrÃ© pour le moment.</p>
      </ng-template>
    </section>

    <!-- Recent Voyages -->
    <section class="recent-section">
      <div class="section-header">
        <h2>Tous les voyages</h2>
        <a routerLink="/voyages" class="view-all">Voir tous â†’</a>
      </div>
      <div class="recent-grid">
        <div class="recent-card" *ngFor="let voyage of stats.recentVoyages" (click)="viewVoyage(voyage)">
          <div class="recent-image" *ngIf="voyage.imageData || voyage.galleries?.[0]">
            <img [src]="voyage.imageData || voyage.galleries?.[0]" [alt]="voyage.titre" />
          </div>
          <div class="recent-info">
            <h3>{{ voyage.titre }}</h3>
            <p class="destination">ğŸ“ {{ voyage.destination }}</p>
            <p class="date">ğŸ—“ï¸ {{ voyage.dateDebut | date: 'dd/MM/yyyy' }}</p>
            <span class="badge" [class.badge-public]="voyage.isPublic" [class.badge-private]="!voyage.isPublic">
              {{ voyage.isPublic ? 'Public' : 'PrivÃ©' }}
            </span>
          </div>
        </div>
      </div>
    </section>
  </div>

  <app-voyage-detail
    *ngIf="selectedVoyage"
    [voyage]="selectedVoyage"
    (close)="closeDetail()"
    (edit)="editVoyage($event)"
    (remove)="removeVoyage($event)"
  ></app-voyage-detail>

  <div class="voyage-form-overlay" *ngIf="showForm">
    <div class="voyage-form-container">
      <button type="button" class="voyage-form-close" (click)="closeForm()" aria-label="Fermer le formulaire">
        Ã—
      </button>
      <app-voyage-form
        [initialValue]="editingVoyage"
        [submitting]="isSaving"
        (cancel)="closeForm()"
        (submitForm)="handleFormSubmit($event)"
      ></app-voyage-form>
    </div>
  </div>
</div>
